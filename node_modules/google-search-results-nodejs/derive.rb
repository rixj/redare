#!/usr/bin/env ruby
# Derive newer search engine.
#
src_service = 'baidu'
src_path = "lib/#{src_service.capitalize}Search.js"
test_path = "test/#{src_service.capitalize}SearchSpec.js"

{
  baidu: 'q',
  yahoo: 'p',
  ebay: "_nkw",
  yandex: 'text',
  google: 'q'
}.each do |engine, q|
  service = engine.to_s
  [
    src_path, 
    test_path
  ].each do |path|
    buffer = File.read(path)
    buffer.gsub!(src_service.capitalize, service.capitalize)
    buffer.gsub!(src_service, service)
    buffer.gsub!(src_service.upcase, service.upcase)
    buffer.gsub!(%q(q: ), %Q(#{q}: ))
    fn = path.gsub(src_service.capitalize, service.capitalize)
    puts "+ #{fn}"
    File.write(fn, buffer)
  end
end